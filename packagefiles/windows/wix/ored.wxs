<?xml version="1.0" encoding="UTF-8"?>

<!--
 * Copyright 2022 Marine Master
 *
 * This file is part of Oldenet.
 *
 * Oldenet is free software: you can redistribute it and/or modify it under the terms of
 * the GNU General Public License as published by the Free Software Foundation, either
 * version 3 of the License, or any later version.
 *
 * Oldenet is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with Oldenet.
 * If not, see <https://www.gnu.org/licenses/>.
-->

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" RequiredVersion="3.11.2.4516">
    <Product Id="FE39C52F-47BD-4BED-96C7-08307BFF22B2"
             Name="Oldenet"
             Language="1033" Version="1.0.1493"
             Manufacturer="Oldenet"
             UpgradeCode="05E713E3-8944-4DBB-B606-901AAA4E01FB">
        <Package InstallerVersion="301"
                 Compressed="yes"
                 Manufacturer="Oldenet"
                 Description="Oldenet" Keywords="Freenet,Oldenet,ored"
                 Comments="(c) 2012 Awesome Company"/>
        <MediaTemplate EmbedCab="yes" CompressionLevel="high"/>

        <UIRef Id="WixUI_Advanced"/>

        <Property Id="ApplicationFolderName" Value="Oldenet"/>
        <Property Id="WixAppFolder" Value="WixPerMachineFolder"/>

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFiles64Folder">
                <Directory Id="APPLICATIONFOLDER" Name="Oldenet"/>
            </Directory>
        </Directory>

        <Feature Id="MainProduct" Title="Oldenet" Level="1">
            <ComponentGroupRef Id="CMP_NewFilesGroup"/>
        </Feature>

        <SetDirectory Id="APPLICATIONFOLDER" Value="[ProgramFiles64Folder][ApplicationFolderName]">
            APPLICATIONFOLDER=""
        </SetDirectory>

        <CustomAction
                Id="OverwriteWixSetDefaultPerMachineFolder"
                Property="WixPerMachineFolder"
                Value="[APPLICATIONFOLDER]"
                Execute="immediate"
        />

        <CustomAction
                Id="SetARPINSTALLLOCATION"
                Property="ARPINSTALLLOCATION"
                Value="[APPLICATIONFOLDER]"
        />

        <InstallUISequence>
            <Custom Action="OverwriteWixSetDefaultPerMachineFolder" After="WixSetDefaultPerMachineFolder"/>
        </InstallUISequence>

        <InstallExecuteSequence>
            <Custom Action="OverwriteWixSetDefaultPerMachineFolder" After="WixSetDefaultPerMachineFolder"/>
            <Custom Action="SetARPINSTALLLOCATION" After="InstallValidate"/>
        </InstallExecuteSequence>

    </Product>
</Wix>